name: "Notify IRC on Push"

on:
  push:
    branches:
      - main
      - development

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Notify IRC
        uses: rectalogic/notify-irc@v1
        with:
          channel: "#OpenZFS-Windows"
          server: "irc.libera.chat"
          nickname: zfs-consus
          message: |
            [openzfs] ${{ github.actor }} pushed ${{ github.event.commits.length }} commit${{ github.event.commits.length != 1 && 's' || '' }} to ${{ github.ref_name }}
            ${{ github.event.compare }}
            ${{ join(github.event.commits[:8].*['id', 'message'] | map("format('{0:.7s} - {1}')"), '\n') }}
            ${{ github.event.commits.length > 8 && '...and more!' || '' }}



